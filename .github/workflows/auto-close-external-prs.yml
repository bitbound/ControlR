name: Auto-close External PRs

on:
  pull_request_target:
    types: [opened]

jobs:
  auto-close:
    runs-on: ubuntu-latest
    if: github.event.pull_request.user.login != 'bitbound' && github.actor != 'dependabot[bot]' && github.actor != 'copilot[bot]'

    permissions:
      pull-requests: write
      issues: write

    steps:
      - name: Close PR with message
        uses: actions/github-script@v8
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const message = `Thank you so much for your interest in ControlR! I really appreciate you taking the time to contribute.

            However, I am not accepting PRs at the moment for the following reasons:

            **Read-Only Mirror**
            For now, the public repository is a read-only mirror. This allows me to work on ideas and experiments in private and only reveal them when they're ready.

            **Legal and Financial Considerations**
            With Remotely, I found out that there are legal impliciations to accepting external contributions.  Since I'm now depending on ControlR to be my primary source of income, it's less complicated and risky if I avoid external contributions for now.

            **Personal Working Style**
            During these early stages of the project, working solo will bring me the most amount of happiness and sense of accomplishment.  It will allow me to move quickly and maintain a clear vision.

            **Reviewing AI Code**
            In my opinion, reviewing code consumes about 4 times as many "mental calories" compared to writing it. With the rise of AI, I'm worried that I'd spend the vast majority of my time reviewing AI-generated PRs, which would detract from my ability to keep the project moving forward.

            I will begin accepting external contributions once ControlR reaches a more mature state and is financially self-sustaining.  Thank you for understanding!

            If you have ideas, suggestions, or found a bug, please feel free to open an issue instead. I'd love to hear your feedback!

            Thank you again for your interest in the project! üôè`;

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              body: message
            });

            await github.rest.pulls.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.issue.number,
              state: 'closed'
            });
