<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:common="using:ControlR.DesktopClient.Common"
             xmlns:controls="using:ControlR.DesktopClient.Controls"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
						 xmlns:vm="using:ControlR.DesktopClient.ViewModels.Mac"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="ControlR.DesktopClient.Views.Mac.PermissionsViewMac"
             x:DataType="vm:IPermissionsViewModelMac">

  <ScrollViewer>
    <StackPanel Spacing="20" Margin="16">
      
      <TextBlock Text="{x:Static common:Localization.Permissions}" Classes="h1" />

      <!-- Accessibility Permission -->
      <StackPanel Spacing="8">
        <TextBlock Text="{x:Static common:Localization.Accessibility}" Classes="h2" />
        <TextBlock Text="{x:Static common:Localization.AccessibilityPermissionDescription}" TextWrapping="Wrap" />
        
        <StackPanel Orientation="Horizontal" Spacing="8">
          <TextBlock Text="{x:Static common:Localization.Status}" VerticalAlignment="Center" />
          
          <controls:If Condition="{Binding IsMacAccessibilityPermissionGranted}">
            <controls:If.True>
              <Border CornerRadius="6" Padding="8,2" Background="{DynamicResource SuccessColor}">
                <TextBlock Text="{x:Static common:Localization.Granted}" 
                           Foreground="{DynamicResource SuccessContrastText}"
                           FontWeight="Bold" />
              </Border>
            </controls:If.True>
            <controls:If.False>
              <Border CornerRadius="6" Padding="8,2" Background="{DynamicResource ErrorColor}">
                <TextBlock Text="{x:Static common:Localization.NotGranted}" 
                           Foreground="{DynamicResource ErrorContrastText}"
                           FontWeight="Bold" />
              </Border>
            </controls:If.False>
          </controls:If>
        </StackPanel>

        <StackPanel Orientation="Horizontal" Spacing="8">
          <Button Content="{x:Static common:Localization.GrantPermission}"
                  Command="{Binding GrantMacAccessibilityPermissionCommand}"
                  IsEnabled="{Binding !IsMacAccessibilityPermissionGranted}" />
          
          <Button Content="{x:Static common:Localization.OpenSettings}"
                  Command="{Binding OpenAccessibilitySettingsCommand}" />
        </StackPanel>
      </StackPanel>

      <!-- Screen Recording Permission -->
      <StackPanel Spacing="8">
        <TextBlock Text="{x:Static common:Localization.ScreenRecording}" Classes="h2" />
        <TextBlock Text="{x:Static common:Localization.ScreenCapturePermissionDescription}" TextWrapping="Wrap" />
        
        <StackPanel Orientation="Horizontal" Spacing="8">
          <TextBlock Text="{x:Static common:Localization.Status}" VerticalAlignment="Center" />
          
          <controls:If Condition="{Binding IsMacScreenCapturePermissionGranted}">
            <controls:If.True>
              <Border CornerRadius="6" Padding="8,2" Background="{DynamicResource SuccessColor}">
                <TextBlock Text="{x:Static common:Localization.Granted}" 
                           Foreground="{DynamicResource SuccessContrastText}"
                           FontWeight="Bold" />
              </Border>
            </controls:If.True>
            <controls:If.False>
              <Border CornerRadius="6" Padding="8,2" Background="{DynamicResource ErrorColor}">
                <TextBlock Text="{x:Static common:Localization.NotGranted}" 
                           Foreground="{DynamicResource ErrorContrastText}"
                           FontWeight="Bold" />
              </Border>
            </controls:If.False>
          </controls:If>
        </StackPanel>

        <StackPanel Orientation="Horizontal" Spacing="8">
          <Button Content="{x:Static common:Localization.GrantPermission}"
                  Command="{Binding GrantMacScreenCapturePermissionCommand}"
                  IsEnabled="{Binding !IsMacScreenCapturePermissionGranted}" />
          
          <Button Content="{x:Static common:Localization.OpenSettings}"
                  Command="{Binding OpenScreenCaptureSettingsCommand}" />
        </StackPanel>
      </StackPanel>

      <!-- Status Message -->
      <Border IsVisible="{Binding PermissionStatusMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
              Background="{DynamicResource InfoColor}"
              CornerRadius="4"
              Padding="12">
        <TextBlock Text="{Binding PermissionStatusMessage}" Foreground="{DynamicResource InfoContrastText}" TextWrapping="Wrap" />
      </Border>

    </StackPanel>
  </ScrollViewer>

</UserControl>
